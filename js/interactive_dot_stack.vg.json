{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "config": {
    "view": {"stroke": null},
    "legend": {
      "labelFontSize": 12,
      "titleFontSize": 14,
      "titleFontWeight": "bold",
      "symbolSize": 150,
      "padding": 10
    }
  },
  "data": {
    "url": "https://raw.githubusercontent.com/dyarmsh/FIT3179-Data-Viz-2/refs/heads/main/data/aus_universities_cleaned.csv"
  },
  "params": [
    {
      "name": "chartSelect",
      "value": "SIZE",
      "bind": {
        "input": "select",
        "options": ["SIZE", "AGE"],
        "labels": ["University Size", "University Age"],
        "name": "Select Chart: "
      }
    }
  ],
  "hconcat": [
    {
      "width": 500,
      "height": 400,
      "layer": [
        {
          "data": {
            "url": "https://raw.githubusercontent.com/dyarmsh/FIT3179-Data-Viz-2/refs/heads/main/js/aus_states.topojson",
            "format": {
              "type": "topojson",
              "feature": "austates"
            }
          },
          "mark": {
            "type": "geoshape",
            "fill": "#f0f0f0",
            "stroke": "#e0e0e0",
            "strokeWidth": 1.5
          }
        },
        {
          "transform": [
            {
              "window": [
                {
                  "op": "row_number",
                  "as": "Australian Rank"
                }
              ]
            },
            {
              "filter": {"param": "brush"}
            }
          ],
          "mark": {
            "type": "circle",
            "opacity": 0.7
          },
          "encoding": {
            "longitude": {"field": "Longitude", "type": "quantitative"},
            "latitude": {"field": "Latitude", "type": "quantitative"},
            "size": {"value": 60},
            "color": {
              "condition": {
                "param": "click",
                "field": "State",
                "type": "nominal",
                "scale": {"scheme": "category10"}
              },
              "value": "lightgray"
            },
            "tooltip": [
              {"field": "Institution Name", "type": "nominal", "title": "University"},
              {"field": "State", "type": "nominal", "title": "State"},
              {"field": "City", "type": "nominal", "title": "City"},
              {"field": "Australian Rank", "type": "quantitative", "title": "2024 Australian Rank"},
              {"field": "2024 RANK", "type": "quantitative", "title": "2024 Rank"},
              {"field": "SIZE", "type": "ordinal", "title": "University Size"}
            ]
          }
        }
      ]
    },
    {
      "width": 400,
      "height": 300,
      "transform": [
        {
          "calculate": "datum[chartSelect]",
          "as": "selectedAttribute"
        }
      ],
      "mark": "bar",
      "params": [
        {"name": "brush", "select": {"type": "interval", "encodings": ["y"]}},
        {"name": "click", "select": {"type": "point", "encodings": ["color"]}}
      ],
      "encoding": {
        "y": {
          "field": "selectedAttribute",
          "type": "nominal",
          "axis": {
            "title": {
              "expr": "chartSelect === 'SIZE' ? 'University Size' : 'University Age'"
            }
          }
        },
        "x": {
          "aggregate": "count",
          "type": "quantitative",
          "title": "Number of Universities"
        },
        "color": {
          "condition": {
            "param": "click",
            "field": "State",
            "type": "nominal",
            "scale": {"scheme": "category10"}
          },
          "value": "lightgray"
        },
        "tooltip": [
          {"field": "State", "type": "nominal", "title": "State"},
          {"aggregate": "count", "type": "quantitative", "title": "Number of Universities"}
        ]
      }
    }
  ]
}
